<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>USB CMSISDAP FW: Upgrade procedure</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">USB CMSISDAP FW
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Upgrade procedure </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document contains the guidelines for updating the USB_CMSISDAP FW on BlueNRG-LP/BlueNRG-LPS development platform with the USB_CMSISDAP_{LP|LPS}.hex binary files available on latest STSW-BNRGLP-DK, BlueNRG-LP, BlueNRG-LPS DK SW package.<br />
 This procedure must be applied only one time on the selected platform, in order to align to the latest version of USB_CMSISDAP binary file.</p>
<h1><a class="anchor" id="U1"></a>
Introduction</h1>
<ul>
<li>The BlueNRG-LP/BlueNRG-LPS development platform USB_CMSISDAP component allows: <ul>
<li>
CMIS-DAP debug/programming capability through the USB micro connector. </li>
<li>
USB to serial bridge providing an I/O communication channel with the BlueNRG-LP/BlueNRG-LPS device (for interfacing to a USB host device as a PC). </li>
<li>
Drag and drop capability for directly programming the BlueNRG-LP/BlueNRG-LPS device. </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="U2"></a>
USB_CMSISDAP FW version check procedure</h1>
<ul>
<li>Preliminary steps (make sure the right Virtual COM driver is available on user PC): <ul>
<li>
Windows 10: no action is required. </li>
</ul>
</li>
</ul>
<ul>
<li>In order to check USB_CMSISDAP firmware version, user must follow these steps: <ul>
<li>
Connect the BlueNRG-LP, STEVAL-IDB011V{1|2} or a BlueNRG-LPS, STEVAL-IDB012V1 development platform to a PC USB port </li>
<li>
Copy the DTM_UART_WITH_UPDATER.hex binary file by Drag-and-drop on the ST-IDB01xVX (this image is available on BlueNRG-LP_LPS SDK: Firmware\BLE_Examples\DTM\{STEVAL-IDB011V1| STEVAL-IDB012V1}) </li>
<li>
Once the image download, open the BlueNRG GUI PC application available on STSW-BNRGUI SW package </li>
<li>
Select the COM port associated to the plugged platform and press Open button </li>
<li>
The <b> Motherboard FW version </b> provides the USB_CMSISDAP FW version </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="U3"></a>
How to perform USB_CMSISDAP firmware upgrade</h1>
<ul>
<li>In order to perform USB_CMSISDAP firmware upgrade, user must follow these steps: <ol>
<li>
Unplug the USB cable (if plugged). </li>
<li>
Press and hold the RESET button. </li>
<li>
Plug the USB cable. </li>
<li>
Release the RESET button. </li>
<li>
A new mass storage device called "MAINTENANCE" appears. </li>
<li>
Copy and paste the new binary image into the mass storage device "MAINTENANCE": <ul>
<li>
Firmware\USB-CMSISDAP\USB_CMSISDAP_LP.hex on BlueNRG-LP kits and Firmware\USB-CMSISDAP\USB_CMSISDAP_LPS.hex on BlueNRG-LPS kits. </li>
</ul>
</li>
<li>
After the operation has been completed, unplug and then plug again the USB cable to make the board startup. </li>
</ol>
</li>
</ul>
<table  border="0">
<tr>
<th></th></tr>
<tr>
<td><div class="image">
<img src="USB_CMSISDAP_FW_MAINTENANCE.jpg" />
</div>
   </td></tr>
<tr align="center">
<td><b style="font-size: 18px; color:blue;"> Figure 1: BlueNRG-LP Development kit: MAINTENANCE mode </b>  </td></tr>
</table>
<h1><a class="anchor" id="U4"></a>
How to check if the USB_CMSISDAP is functional</h1>
<ul>
<li>In order to check if all the system is ready to use, just make the following checks: <ol>
<li>
<p class="startli">Ensure the USB_CMSISDAP device is present in the Windows OS, Device Manager:</p>
<table  border="0">
<tr>
<th></th></tr>
<tr>
<td><div class="image">
<img src="USB_CMSISDAP_FW_DEVICEMANAGER.jpg" />
</div>
   </td></tr>
<tr align="center">
<td><b style="font-size: 18px; color:blue;"> Figure 2: BlueNRG-LP Development kit: Device Manager </b>  </td></tr>
</table>
<p class="endli"></p>
</li>
<li>
<p class="startli">Ensure that the mass storage device "ST IDB011VX" is present on the Devices and drives (if the board is powered by USB cable and connected to a PC ):</p>
<table  border="0">
<tr>
<th></th></tr>
<tr>
<td><div class="image">
<img src="USB_CMSISDAP_FW_DeviceDrivers.jpg" />
</div>
   </td></tr>
<tr align="center">
<td><b style="font-size: 18px; color:blue;"> Figure 3: BlueNRG-LP Development kit: Devices and drivers </b>  </td></tr>
</table>
<p class="endli"></p>
</li>
<li>
The LED DL1 is ON (if the board is powered by USB). </li>
</ol>
</li>
</ul>
<ul>
<li>NOTE: the component of the Composite device: "WebUSB: CMSIS-DAP could be not installed. This is not relevant since the functionality is not used.</li>
</ul>
<table  border="0">
<tr>
<th></th></tr>
<tr>
<td><div class="image">
<img src="STEVAL-IDB011V2_CMSIS_DAP.jpg" />
</div>
   </td></tr>
<tr align="center">
<td><b style="font-size: 18px; color:blue;"> Figure 4: STEVAL-IDB011Vx Development kit (BlueNRG-LP, QFN48 package) </b>  </td></tr>
</table>
<h1><a class="anchor" id="U5"></a>
How to perform USB_CMSISDAP firmware upgrade through BlueNRG GUI</h1>
<ul>
<li>BlueNRG GUI "Tools, Flash Motherboard FW ..." also allows to update the USB_CMSISDAP firmware on the selected platform. </li>
<li>Refer to the BlueNRG GUI UM2058 document for detailed information. </li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2022 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
