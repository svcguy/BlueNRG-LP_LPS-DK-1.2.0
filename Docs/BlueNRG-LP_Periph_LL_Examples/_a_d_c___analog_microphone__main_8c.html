<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-LP/BlueNRG-LPS Peripherals drivers LL Examples: ADC_AnalogMicrophone_main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-LP/BlueNRG-LPS Peripherals drivers LL Examples
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ADC_AnalogMicrophone_main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This example shows how to use the ADC peripheral to interface an analog microphone.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;rf_driver_ll_adc.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_rcc.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_bus.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_system.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_exti.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_cortex.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_utils.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_pwr.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_dma.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_usart.h&quot;</code><br />
<code>#include &quot;bluenrg_lpx.h&quot;</code><br />
<code>#include &quot;rf_driver_ll_gpio.h&quot;</code><br />
<code>#include &quot;bluenrg_lp_evb_config.h&quot;</code><br />
</div>
<p><a href="_a_d_c___analog_microphone__main_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_h_p___filter_state___type_def.html">HP_FilterState_TypeDef</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afb134291fff6dfdc86740cbc3db6bb62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#afb134291fff6dfdc86740cbc3db6bb62">PCM_BUFFER_SIZE</a>&#160;&#160;&#160;(2600 * 2)</td></tr>
<tr class="separator:afb134291fff6dfdc86740cbc3db6bb62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43b4d88c8075f3957a543ecfff8cb65"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#af43b4d88c8075f3957a543ecfff8cb65">USER_CONFIG_PGA_BIAS</a>&#160;&#160;&#160;(LL_ADC_PGA_BIAS_050_BAT)</td></tr>
<tr class="separator:af43b4d88c8075f3957a543ecfff8cb65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b4e65dbe7843b3a965c3dbdc2bb604"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#a41b4e65dbe7843b3a965c3dbdc2bb604">USER_CONFIG_PGA_GAIN</a>&#160;&#160;&#160;(LL_ADC_PGA_GAIN_30_DB)</td></tr>
<tr class="separator:a41b4e65dbe7843b3a965c3dbdc2bb604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e410d604a2950e12d04f60ccbc0678"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#a11e410d604a2950e12d04f60ccbc0678">USER_CONFIG_MIC_FREQ</a>&#160;&#160;&#160;(LL_ADC_OUTPUT_FREQ_MIC_ANA_7936_HZ)</td></tr>
<tr class="separator:a11e410d604a2950e12d04f60ccbc0678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad064c0942e0129335d298f34563b1979"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#ad064c0942e0129335d298f34563b1979">USER_CONFIG_SAMPLE_RATE</a>&#160;&#160;&#160;(LL_ADC_SAMPLE_RATE_16)</td></tr>
<tr class="separator:ad064c0942e0129335d298f34563b1979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5540952abebe11ce81ceead7197a8e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#ac5540952abebe11ce81ceead7197a8e4">LL_DMA_CHANNEL_ADC</a>&#160;&#160;&#160;LL_DMA_CHANNEL_3</td></tr>
<tr class="separator:ac5540952abebe11ce81ceead7197a8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06bb72a405d696bf9d8b5812fa62e683"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#a06bb72a405d696bf9d8b5812fa62e683">SaturaLH</a>(N,  L,  H)&#160;&#160;&#160;(((N)&lt;(L))?(L):(((N)&gt;(H))?(H):(N)))</td></tr>
<tr class="separator:a06bb72a405d696bf9d8b5812fa62e683"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:a840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">The application entry point.  <a href="#a840291bc02cba5474a4cb46a9b9566fe">More...</a><br /></td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fca8b8a3ce0431d9aebbf432eda751"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#ac1fca8b8a3ce0431d9aebbf432eda751">DMA_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:ac1fca8b8a3ce0431d9aebbf432eda751"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function handles DMA channel 1 interrupt request.  <a href="#ac1fca8b8a3ce0431d9aebbf432eda751">More...</a><br /></td></tr>
<tr class="separator:ac1fca8b8a3ce0431d9aebbf432eda751"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8410743860cb60925c9c9b52cf9f0b21"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_h_p___filter_state___type_def.html">HP_FilterState_TypeDef</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_c___analog_microphone__main_8c.html#a8410743860cb60925c9c9b52cf9f0b21">HP_Filter</a></td></tr>
<tr class="separator:a8410743860cb60925c9c9b52cf9f0b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This example shows how to use the ADC peripheral to interface an analog microphone. </p>
<h1><a class="anchor" id="KEIL_project"></a>
KEIL project</h1>
<p>To use the project with KEIL uVision 5 for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the KEIL uVision 5 for ARM and select Project-&gt;Open Project menu.</li>
<li>Open the KEIL project <code>C:\Users\{username}\ST\BlueNRG-LP_LPS DK x.x.x\Projects\Periph_Examples\LL\ADC\ADC_AnalogMicrophone\MDK-ARM\{STEVAL-IDB011V1}\ADC_AnalogMicrophone.uvprojx</code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild all target files. This will recompile and link the entire application</li>
<li>To download the binary image, please connect an USB cable in your board (CMSIS-DAP upgrade).</li>
<li>Select Project-&gt;Download to download the related binary image.</li>
<li>Alternatively, open the BlueNRG-LP Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="IAR_project"></a>
IAR project</h1>
<p>To use the project with IAR Embedded Workbench for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the Embedded Workbench for ARM and select File-&gt;Open-&gt;Workspace menu.</li>
<li>Open the IAR project <code>C:\Users\{username}\ST\BlueNRG-LP_LPS DK x.x.x\Projects\Periph_Examples\LL\ADC\ADC_AnalogMicrophone\EWARM\{STEVAL-IDB011V1}\ADC_AnalogMicrophone.eww</code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild All. This will recompile and link the entire application</li>
<li>To download the binary image, please connect an USB cable in your board (CMSIS-DAP upgrade).</li>
<li>Select Project-&gt;Download and Debug to download the related binary image.</li>
<li>Alternatively, open the Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="WISE_project"></a>
WiSE-Studio project</h1>
<p>To use the project with WiSE-Studio IDE (GCC toolchain), please follow the instructions below:</p><ol type="1">
<li>Open the WiSE-Studio IDE</li>
<li>Select File, Import, Existing Projects into Workspace <code>C:\Users\{username}\ST\BlueNRG-LP_LPS DK x.x.x\Projects\Periph_Examples\LL\ADC\ADC_AnalogMicrophone\WiSE-Studio\{STEVAL-IDB011V1}</code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Build Project. This will recompile and link the entire application</li>
<li>To download the binary image, please connect an USB cable in your board (CMSIS-DAP upgrade).</li>
<li>Select Run-&gt;Run/Debug to download the related binary image.</li>
<li>Alternatively, open the Flasher utility and download the built binary image.</li>
</ol>
<h2><a class="anchor" id="Project_configurations"></a>
Project configurations</h2>
<ul>
<li><code>Release</code> - Release configuration</li>
</ul>
<h1><a class="anchor" id="Board_supported"></a>
Boards supported</h1>
<ul>
<li><code>STEVAL-IDB011V1</code> </li>
<li><code>STEVAL-IDB011V2</code> </li>
</ul>
<h1><a class="anchor" id="Power_settings"></a>
Power configuration settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB01xV1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Jumper name</td><td id="LastColumn">Description </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>JP2</b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">USB</td><td id="LastColumn">USB supply power </td></tr>
<tr id="LastRow">
<td id="FirstColumn">BAT</td><td id="LastColumn">The supply voltage must be provided through battery pins. </td></tr>
</table>
<h1><a class="anchor" id="Jumper_settings"></a>
Jumper settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB01xV1</b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>Jumper name</b></td><td id="LastColumn"><b>Description</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP1</td><td id="LastColumn">It provides the voltage to the BlueNRG-LP circuit. It must be fitted. It can be used for current measurements of the BlueNRG-LP device. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP2</td><td id="LastColumn">It is a switch between two power domains. BAT position: to provide power from battery holder; USB position: to provide power from USB connector. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP3</td><td id="LastColumn">It connects the BLE_SWCLK pin of the BlueNRG-LP with the SWCLK pin of the USB_CMSISDAP. It must be fitted. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP4</td><td id="LastColumn">It connects the BLE_SWDIO pin of the BlueNRG-LP with the SWDIO pin of the USB_CMSISDAP. It must be fitted. </td></tr>
<tr id="LastRow">
<td id="FirstColumn">JP5</td><td id="LastColumn">It connects the BLE_RSTN pin of the BlueNRG-LP with the rest of the board (the USB_CMSISDAP and RESET push button). It must be fitted. </td></tr>
</table>
<h1><a class="anchor" id="Pin_settings"></a>
Pin settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>PIN name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="LastColumn"><b>STEVAL-IDB011V2</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A0</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A1</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A10</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A11</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A12</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A13</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A14</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A15</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A3</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A4</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A5</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A6</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A7</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A8</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A9</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B0</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B1</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B12</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B13</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B14</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B15</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B2</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B3</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B4</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B5</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B6</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B7</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B8</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B9</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">GND</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">RST</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">VBAT</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
</table>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>Parameter name</b></td><td id="MiddleColumn"><b>Value</b></td><td id="LastColumn"><b>Unit</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Baudrate</td><td id="MiddleColumn">921600 [default]</td><td id="LastColumn">bit/sec </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Data bits</td><td id="MiddleColumn">8</td><td id="LastColumn">bit </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Parity</td><td id="MiddleColumn">None</td><td id="LastColumn">bit </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Start bits</td><td id="MiddleColumn">1</td><td id="LastColumn">bit </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Stop bits</td><td id="MiddleColumn">1</td><td id="LastColumn">bit </td></tr>
<tr id="LastRow">
<td id="FirstColumn">HW flow control</td><td id="MiddleColumn">None</td><td id="LastColumn">bit </td></tr>
</table>
<h1><a class="anchor" id="LEDs_description"></a>
LEDs description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>LED name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="LastColumn"><b>STEVAL-IDB011V2</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL1</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL2</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL3</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL4</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">U5</td><td id="MiddleColumn">Activity LED</td><td id="LastColumn">Activity LED </td></tr>
</table>
<h1><a class="anchor" id="LEDs_description"></a>
LEDs description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>LED name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="LastColumn"><b>STEVAL-IDB011V2</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL1</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL2</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL3</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL4</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">U5</td><td id="MiddleColumn">Activity LED</td><td id="LastColumn">Activity LED </td></tr>
</table>
<h1><a class="anchor" id="Buttons_description"></a>
Buttons description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>PIN name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V{1</b></td><td id="LastColumn"><b>2}</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A1</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A11</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A12</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A13</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A14</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A15</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A4</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A5</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A6</td><td id="LastColumn">U5 </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A7</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A8</td><td id="LastColumn">USART TX </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A9</td><td id="LastColumn">USART RX </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B0</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B14</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B2</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B3</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B4</td><td id="LastColumn">PGA_VIN </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B5</td><td id="LastColumn">VBIAS_MIC </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B7</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B8</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B9</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A0</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A10</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B1</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B6</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B15</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">GND</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">RST</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">VBAT</td><td id="LastColumn">Not Used </td></tr>
</table>
<h1><a class="anchor" id="Usage"></a>
Usage</h1>
<p>This example shows how to use the ADC peripheral to interface an analog microphone. The DMA peripheral is used to transfer the data output from the ADC output register to a RAM buffer. Then, the data are printed out by using the USART peripheral. This example is driven by interrupts from the DMA peripheral: Half Transfer and Transfer Complete events. This example is based on the BLUENRG_LP ADC LL API. The peripheral initialization is done using LL unitary service functions for optimization purposes (performance and size).</p>
<p>Example configuration: The ADC is configured to sample the output data coming from an analog microphone connected to the PGA port of the ADC peripheral. The user can change the PGA setting and the sample rate of the ADC. The USART baudrate is set to 921600 bps for maintain high performance.</p>
<p>Example execution: The user must connect the analog microphone according to the application circuit suggested for the specific analog microphone. The input port is the pin PB4. The BlueNRG-LP provides also a Vbias for the analog microphone from the pin PB5. The specific Vbias voltage can be set by user. The user can get the output data by logging the data through a serial terminal and then process the audio stream acquired.</p>
<p>Connection needed: PB4 must be connected to the output of the analog microphone, it is recommended to use a capacitor of 1 uF, see Reference Manual. PB5 must be connected to supply the input voltage to the analog microphone.</p>
<p>Other peripherals used: 1 USART for output the data acquired 1 DMA for transfer the output data from the ADC to the RAM memory </p>

<p>Definition in file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ac5540952abebe11ce81ceead7197a8e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LL_DMA_CHANNEL_ADC&#160;&#160;&#160;LL_DMA_CHANNEL_3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00273">273</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="afb134291fff6dfdc86740cbc3db6bb62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCM_BUFFER_SIZE&#160;&#160;&#160;(2600 * 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00266">266</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a06bb72a405d696bf9d8b5812fa62e683"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SaturaLH</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">L, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">H&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((N)&lt;(L))?(L):(((N)&gt;(H))?(H):(N)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00495">495</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a11e410d604a2950e12d04f60ccbc0678"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USER_CONFIG_MIC_FREQ&#160;&#160;&#160;(LL_ADC_OUTPUT_FREQ_MIC_ANA_7936_HZ)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00270">270</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="af43b4d88c8075f3957a543ecfff8cb65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USER_CONFIG_PGA_BIAS&#160;&#160;&#160;(LL_ADC_PGA_BIAS_050_BAT)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00268">268</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a41b4e65dbe7843b3a965c3dbdc2bb604"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USER_CONFIG_PGA_GAIN&#160;&#160;&#160;(LL_ADC_PGA_GAIN_30_DB)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00269">269</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad064c0942e0129335d298f34563b1979"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USER_CONFIG_SAMPLE_RATE&#160;&#160;&#160;(LL_ADC_SAMPLE_RATE_16)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00271">271</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac1fca8b8a3ce0431d9aebbf432eda751"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DMA_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function handles DMA channel 1 interrupt request. </p>

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00563">563</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The application entry point. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00311">311</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a8410743860cb60925c9c9b52cf9f0b21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_h_p___filter_state___type_def.html">HP_FilterState_TypeDef</a> HP_Filter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html#l00493">493</a> of file <a class="el" href="_a_d_c___analog_microphone__main_8c_source.html">ADC_AnalogMicrophone_main.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2022 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
