<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-LP/BlueNRG-LPS DK: Bluetooth LE examples: P_main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-LP/BlueNRG-LPS DK: Bluetooth LE examples
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">P_main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This application contains an example which shows how implementing a Bluetooth LE security scenario on a peripheral device.  
<a href="#details">More...</a></p>

<p><a href="_p__main_8c_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This application contains an example which shows how implementing a Bluetooth LE security scenario on a peripheral device. </p>
<h1><a class="anchor" id="KEIL_project"></a>
KEIL project</h1>
<p>To use the project with KEIL uVision 5 for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the KEIL uVision 5 for ARM and select Project-&gt;Open Project menu.</li>
<li>Open the KEIL project <code>C:\Users\{username}\ST\BlueNRG-LP_LPS DK x.x.x\Project\BLE_Examples\BLE_Security\MDK-ARM\{STEVAL-IDB011V1|STEVAL-IDB012V1}\BLE_Security.uvprojx</code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild all target files. This will recompile and link the entire application</li>
<li>To download the binary image, please connect an USB cable in your board (CMSIS-DAP upgrade).</li>
<li>Select Debug-&gt;Start/Stop Debug Sessionto download the related binary image.</li>
<li>Alternatively, open the Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="IAR_project"></a>
IAR project</h1>
<p>To use the project with IAR Embedded Workbench for ARM, please follow the instructions below:</p><ol type="1">
<li>Open the Embedded Workbench for ARM and select File-&gt;Open-&gt;Workspace menu.</li>
<li>Open the IAR project <code>C:\Users\{username}\ST\BlueNRG-LP_LPS DK x.x.x\Project\BLE_Examples\BLE_Security\EWARM\{STEVAL-IDB011V1|STEVAL-IDB012V1}\BLE_Security.eww</code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Rebuild All. This will recompile and link the entire application</li>
<li>To download the binary image, please connect an USB cable in your board (CMSIS-DAP upgrade).</li>
<li>Select Project-&gt;Download and Debug to download the related binary image.</li>
<li>Alternatively, open the Flasher utility and download the built binary image.</li>
</ol>
<h1><a class="anchor" id="WISE_project"></a>
WiSE-Studio project</h1>
<p>To use the project with WiSE-Studio IDE (GCC toolchain), please follow the instructions below:</p><ol type="1">
<li>Open the WiSE-Studio IDE</li>
<li>Select File, Import, Existing Projects into Workspace <code>C:\Users\{username}\ST\BlueNRG-LP_LPS DK x.x.x\Project\BLE_Examples\BLE_Security\WiSE-Studio\{STEVAL-IDB011V1|STEVAL-IDB012V1}</code></li>
<li>Select desired configuration to build</li>
<li>Select Project-&gt;Build Project. This will recompile and link the entire application</li>
<li>To download the binary image, please connect an USB cable in your board (CMSIS-DAP upgrade).</li>
<li>Select Run-&gt;Run/Debug to download the related binary image.</li>
<li>Alternatively, open the Flasher utility and download the built binary image.</li>
</ol>
<h2><a class="anchor" id="Project_configurations"></a>
Project configurations</h2>
<ul>
<li><code>Slave_JustWorks</code> - Peripheral Security Just Works configuration</li>
<li><code>Slave_NumericComp</code> - Peripheral Security Numeric Comparison configuration</li>
<li><code>Slave_PassKey_Fixed</code> - Peripheral Security Pass Key entry (fixed pin) configuration</li>
<li><code>Slave_PassKey_Random</code> - Peripheral Security Pass Key entry (no fixed pin) configuration</li>
</ul>
<h1><a class="anchor" id="Board_supported"></a>
Boards supported</h1>
<ul>
<li><code>STEVAL-IDB011V1</code> </li>
<li><code>STEVAL-IDB011V2</code> </li>
<li><code>STEVAL-IDB012V1</code> </li>
</ul>
<h1><a class="anchor" id="Power_settings"></a>
Power configuration settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB01xV1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Jumper name</td><td id="LastColumn">Description </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>JP2</b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">USB</td><td id="LastColumn">USB supply power </td></tr>
<tr id="LastRow">
<td id="FirstColumn">BAT</td><td id="LastColumn">The supply voltage must be provided through battery pins. </td></tr>
</table>
<h1><a class="anchor" id="Jumper_settings"></a>
Jumper settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>STEVAL-IDB01xV1</b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>Jumper name</b></td><td id="LastColumn"><b>Description</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP1</td><td id="LastColumn">It provides the voltage to the BlueNRG-LP circuit. It must be fitted. It can be used for current measurements of the BlueNRG-LP device. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP2</td><td id="LastColumn">It is a switch between two power domains. BAT position: to provide power from battery holder; USB position: to provide power from USB connector. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP3</td><td id="LastColumn">It connects the BLE_SWCLK pin of the BlueNRG-LP with the SWCLK pin of the USB_CMSISDAP. It must be fitted. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">JP4</td><td id="LastColumn">It connects the BLE_SWDIO pin of the BlueNRG-LP with the SWDIO pin of the USB_CMSISDAP. It must be fitted. </td></tr>
<tr id="LastRow">
<td id="FirstColumn">JP5</td><td id="LastColumn">It connects the BLE_RSTN pin of the BlueNRG-LP with the rest of the board (the USB_CMSISDAP and RESET push button). It must be fitted. </td></tr>
</table>
<h1><a class="anchor" id="Pin_settings"></a>
Pin settings</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Random</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Fixed</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_JustWorks</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_NumericComp</b></td><td id="MiddleColumn"><b></b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>PIN name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="LastColumn"><b>STEVAL-IDB012V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A0</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A10</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A11</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A12</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A13</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A14</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A15</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A3</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A5</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A6</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A7</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A8</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">A9</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B0</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B1</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B12</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B13</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B14</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B15</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B3</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B5</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B6</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">N.A.</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B7</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B8</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">B9</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">N.A.</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">N.A. </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">GND</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">RST</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">VBAT</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
</table>
<h1><a class="anchor" id="Serial_IO"></a>
Serial I/O</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b>Parameter name</b></td><td id="MiddleColumn"><b>Value</b></td><td id="LastColumn"><b>Unit</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Baudrate</td><td id="MiddleColumn">115200 [default]</td><td id="LastColumn">bit/sec </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Data bits</td><td id="MiddleColumn">8</td><td id="LastColumn">bit </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Parity</td><td id="MiddleColumn">None</td><td id="LastColumn">bit </td></tr>
<tr id="LastRow">
<td id="FirstColumn">Stop bits</td><td id="MiddleColumn">1</td><td id="LastColumn">bit </td></tr>
</table>
<h1><a class="anchor" id="LEDs_description"></a>
LEDs description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Random</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Fixed</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_JustWorks</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_NumericComp</b></td><td id="MiddleColumn"><b></b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>LED name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="LastColumn"><b>STEVAL-IDB012V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL1</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL3</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">DL4</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">U5</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
</table>
<h1><a class="anchor" id="Buttons_description"></a>
Buttons description</h1>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Random</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Fixed</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_JustWorks</b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b></b></td><td id="MiddleColumn"><b>Slave_NumericComp</b></td><td id="MiddleColumn"><b></b></td><td id="LastColumn"><b></b> </td></tr>
<tr id="HeadRow">
<td id="FirstColumn"><b>BUTTON name</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="MiddleColumn"><b>STEVAL-IDB012V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V1</b></td><td id="MiddleColumn"><b>STEVAL-IDB011V2</b></td><td id="LastColumn"><b>STEVAL-IDB012V1</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">PUSH1</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="MiddleColumn">BLE disconnection</td><td id="LastColumn">BLE disconnection </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">PUSH2</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="MiddleColumn">Not Used</td><td id="LastColumn">Not Used </td></tr>
<tr id="LastRow">
<td id="FirstColumn">RESET</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LPS</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LPS</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LPS</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="MiddleColumn">Reset BlueNRG-LP</td><td id="LastColumn">Reset BlueNRG-LPS </td></tr>
</table>
<h1><a class="anchor" id="Usage"></a>
Usage</h1>
<p>This demo addresses some examples of Bluetooth Low Energy Security scenarios:</p>
<ul>
<li>Pairing with pass key entry method (no fixed pin) and bonding (select: Peripheral_PassKey_Random and Master_PassKey_Random projects configurations)</li>
<li>Pairing with pass key entry method (with fixed pin) and bonding (select: Peripheral_PassKey_Fixed and Master_PassKey_Fixed projects configurations)</li>
<li>Pairing with just works method and bonding (select: Peripheral_JustWorks and Master_JustWorks projects configurations)</li>
<li>Pairing with Numeric Comparison(Bluetooth LE V4.2 security feature) and bondig (select: Peripheral_NumericComp and Master_NumericComp projects configurations)</li>
</ul>
<p>In order to exercise each specific security scenario, each Peripheral project configuration must be used with the related Master project configuration as follows:</p>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Random</b></td><td id="MiddleColumn"><b>Slave_PassKey_Fixed</b></td><td id="MiddleColumn"><b>Slave_JustWorks</b></td><td id="LastColumn"><b>Slave_NumericComp</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Master_PassKey_Random</td><td id="MiddleColumn">X</td><td id="MiddleColumn"></td><td id="MiddleColumn"></td><td id="LastColumn"></td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Master_PassKey_Fixed</td><td id="MiddleColumn"></td><td id="MiddleColumn">X</td><td id="MiddleColumn"></td><td id="LastColumn"></td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Master_JustWorks</td><td id="MiddleColumn"></td><td id="MiddleColumn"></td><td id="MiddleColumn">X</td><td id="LastColumn"></td></tr>
<tr id="LastRow">
<td id="FirstColumn">Master_NumericComp</td><td id="MiddleColumn"></td><td id="MiddleColumn"></td><td id="MiddleColumn"></td><td id="LastColumn">X </td></tr>
</table>
<p>The following tables describes the projects main security settings, which combination lead to the selection of the specific Bluetooth Low Energy Security scenario (PassKey entry with random pin, PassKey entry with fixed pin, Just works, Numeric Value Comparison).</p>
<ul>
<li>Peripheral (Slave) device security settings</li>
</ul>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Slave_PassKey_Random</b></td><td id="MiddleColumn"><b>Slave_PassKey_Fixed</b></td><td id="MiddleColumn"><b>Slave_JustWorks</b></td><td id="LastColumn"><b>Slave_NumericComp</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO capability</td><td id="MiddleColumn">Display Only</td><td id="MiddleColumn">Display Only</td><td id="MiddleColumn">Display Only</td><td id="LastColumn">Keyboard Display </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Use Fixed Pin</td><td id="MiddleColumn">NO</td><td id="MiddleColumn">YES</td><td id="MiddleColumn">YES</td><td id="LastColumn">YES </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">MITM mode</td><td id="MiddleColumn">Required</td><td id="MiddleColumn">Required</td><td id="MiddleColumn">Not Required</td><td id="LastColumn">Required </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">LE Secure support</td><td id="MiddleColumn">Supported but optional</td><td id="MiddleColumn">Supported but optional</td><td id="MiddleColumn">Supported but optional</td><td id="LastColumn">Supported but optional </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Key Press Notification</td><td id="MiddleColumn">Not supported</td><td id="MiddleColumn">Not supported</td><td id="MiddleColumn">Not supported</td><td id="LastColumn">Not supported </td></tr>
<tr id="LastRow">
<td id="FirstColumn">Identity Address</td><td id="MiddleColumn">Public</td><td id="MiddleColumn">Public</td><td id="MiddleColumn">Public</td><td id="LastColumn">Public </td></tr>
</table>
<ul>
<li>Central (Master) device security settings</li>
</ul>
<table  id="DoxyEmbeddedTable" border="1">
<tr id="HeadRow">
<td id="FirstColumn"><b></b></td><td id="MiddleColumn"><b>Master_PassKey_Random</b></td><td id="MiddleColumn"><b>Master_PassKey_Fixed</b></td><td id="MiddleColumn"><b>Master_JustWorks</b></td><td id="LastColumn"><b>Master_NumericComp</b> </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">IO capability</td><td id="MiddleColumn">Keyboard Only</td><td id="MiddleColumn">Keyboard Only</td><td id="MiddleColumn">Display Only</td><td id="LastColumn"></td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Use Fixed Pin</td><td id="MiddleColumn">NO</td><td id="MiddleColumn">YES</td><td id="MiddleColumn">NO</td><td id="LastColumn"></td></tr>
<tr id="BodyRow">
<td id="FirstColumn">MITM mode</td><td id="MiddleColumn">Required</td><td id="MiddleColumn">Required</td><td id="MiddleColumn">Not Required</td><td id="LastColumn"></td></tr>
<tr id="BodyRow">
<td id="FirstColumn">LE Secure support (1)</td><td id="MiddleColumn">Supported and mandatory</td><td id="MiddleColumn">Supported and mandatory</td><td id="MiddleColumn">Supported and mandatory</td><td id="LastColumn">Supported and mandatory (2) </td></tr>
<tr id="BodyRow">
<td id="FirstColumn">Key Press Notification</td><td id="MiddleColumn">Not supported</td><td id="MiddleColumn">Not supported</td><td id="MiddleColumn">Not supported</td><td id="LastColumn">Not supported </td></tr>
<tr id="LastRow">
<td id="FirstColumn">Identity Address</td><td id="MiddleColumn">Public</td><td id="MiddleColumn">Public</td><td id="MiddleColumn">Public</td><td id="LastColumn">Public </td></tr>
</table>
<ul>
<li>NOTES:<ul>
<li>(1) Set to Seupported and mandatory in order to force the Bluetooth LE V4.2 LE Secure connections when Central device connects to Peripheral device.</li>
<li>(2) Set to mandatory in order to trigger Numeric Comparison (it is supported on new Bluetooth LE V 4.2 LE Secure Connections mode)</li>
</ul>
</li>
</ul>
<p>Central device is using the Central/Master library (refer to the related html documentation for more information). </p><pre class="fragment"> Pairing with pass key entry method (no fixed pin) and bonding:
</pre><p>On reset, after initialization, Peripheral device sets security IO capability as display only (IO_CAP_DISPLAY_ONLY) and set authentication requirements as follow:</p>
<ul>
<li>MITM authentication (MITM_PROTECTION_REQUIRED)</li>
<li>don't use fixed pin (DONOT_USE_FIXED_PIN_FOR_PAIRING)</li>
<li>Secure connection supported but optional (SC_IS_SUPPORTED)</li>
<li>Key press notification not supported (KEYPRESS_IS_NOT_SUPPORTED)</li>
<li>Identity address public (0x00)</li>
<li>bonding required (BONDING)</li>
<li>NOTE: the security pin is randomly generated using the hci_le_rand() API. The Pass Key value displayed on Peripheral hyper terminal must be inserted on Central device hyper terminal (Central device has IO capability keyboard only: IO_CAP_KEYBOARD_ONLY).</li>
</ul>
<p>After initialization phase, Peripheral device defines a custom service with 2 proprietary characteristics (UUID 128 bits):</p>
<ul>
<li>TX characteristic: notification (CHAR_PROP_NOTIFY), no security (ATTR_PERMISSION_NONE);</li>
<li>RX characteristic with properties: read (CHAR_PROP_READ), Link must be encrypted to read (ATTR_PERMISSION_ENCRY_READ), Need authentication to read (ATTR_PERMISSION_AUTHEN_READ), GATT_NOTIFY_READ_REQ_AND_WAIT_FOR_APPL_RES (application is notified when a read request of any type is received for this attribute).</li>
</ul>
<p>The Peripheral device enters in discovery mode with local name SlaveSec_A2. When a Central device starts the discovery procedure and detects the Peripheral device, the two devices connects. After connection, Peripheral device starts a slave security request to the Central device (aci_gap_slave_security_req()) and , as consequence, Central devices starts pairing procedure. After devices pairs and get bonded, Peripheral device displays the list of its bonded devices and configures its white list in order to add the bonded Central device to its white list. Central devices starts the service discovery procedure to identify the Peripheral service and characteristics and, then, enabling the TX characteristic notification. Peripheral device starts TX characteristic notification to the Central device at periodic interval, and it provides the RX characteristic value to the Central device each time it reads it. When connected, if user presses the Bluetooth LE platform button PUSH1, Peripheral device disconnects and enters in undirected connectable mode with filtering enabled (WHITE_LIST_FOR_ALL: Process scan and connection requests only from devices in the White List). This implies that Peripheral device accepts connection requests only from devices on its white list: Central device is still be able to connect to the Peripheral device; any other device connection requests are not accepted from the Peripheral device. </p><pre class="fragment"> Pairing with pass key entry method (with fixed pin) and bonding:
</pre><p>On reset, after initialization, Peripheral device sets security IO capability as display only (IO_CAP_DISPLAY_ONLY) and set authentication requirements as follow:</p>
<ul>
<li>MITM authentication (MITM_PROTECTION_REQUIRED)</li>
<li>use fixed pin (USE_FIXED_PIN_FOR_PAIRING)</li>
<li>Secure connection supported but optional (SC_IS_SUPPORTED)</li>
<li>Key press notification not supported (KEYPRESS_IS_NOT_SUPPORTED)</li>
<li>Identity address public (0x00)</li>
<li>bonding required (BONDING)</li>
<li>NOTE: the security pin is fixed (PERIPHERAL_SECURITY_KEY on file BLE_Security_Peripheral.h).</li>
</ul>
<p>After initialization phase, Peripheral device defines a custom service with 2 proprietary characteristics (UUID 128 bits):</p>
<ul>
<li>TX characteristic: notification (CHAR_PROP_NOTIFY), no security (ATTR_PERMISSION_NONE);</li>
<li>RX characteristic with properties: read (CHAR_PROP_READ), Link must be encrypted to read (ATTR_PERMISSION_ENCRY_READ), Need authentication to read (ATTR_PERMISSION_AUTHEN_READ), GATT_NOTIFY_READ_REQ_AND_WAIT_FOR_APPL_RES (application is notified when a read request of any type is received for this attribute).</li>
</ul>
<p>The Peripheral device enters in discovery mode with local name SlaveSec_A1. When a Central device starts the discovery procedure and detects the Peripheral device, the two devices connects. After connection, Peripheral device starts a slave security request to the Central device (aci_gap_slave_security_req()) and , as consequence, Central devices starts pairing procedure. After devices pairs and get bonded, Peripheral device displays the list of its bonded devices and configures its white list in order to add the bonded Central device to its white list. Central devices starts the service discovery procedure to identify the Peripheral service and characteristics and, then, enabling the TX characteristic notification. Peripheral device starts TX characteristic notification to the Central device at periodic interval, and it provides the RX characteristic value to the Central device each time it reads it. When connected, if user presses the Bluetooth LE platform button PUSH1, Peripheral device disconnects and enters in undirected connectable mode mode with filtering enabled (WHITE_LIST_FOR_ALL: Process scan and connection requests only from devices in the White List). This implies that Peripheral device accepts connection requests only from devices on its white list: Central device is still be able to connect to the Peripheral device; any other device connection requests are not accepted from the Peripheral device. </p><pre class="fragment"> Pairing with just works  method and bonding.
</pre><p>On reset, after initialization, Peripheral device sets security IO capability as display only (IO_CAP_DISPLAY_ONLY) and set authentication requirements as follow:</p>
<ul>
<li>MITM authentication (MITM_PROTECTION_NOT_REQUIRED)</li>
<li>use fixed pin (USE_FIXED_PIN_FOR_PAIRING)</li>
<li>Secure connection supported but optional (SC_IS_SUPPORTED)</li>
<li>Key press notification not supported (KEYPRESS_IS_NOT_SUPPORTED)</li>
<li>Identity address public (0x00)</li>
<li>bonding required (BONDING)</li>
</ul>
<p>After initialization phase, Peripheral device defines a custom service with 2 proprietary characteristics (UUID 128 bits):</p>
<ul>
<li>TX characteristic: notification (CHAR_PROP_NOTIFY), no security (ATTR_PERMISSION_NONE);</li>
<li>RX characteristic with properties: read (CHAR_PROP_READ), Link must be encrypted to read (ATTR_PERMISSION_ENCRY_READ) GATT_NOTIFY_READ_REQ_AND_WAIT_FOR_APPL_RES (application is notified when a read request of any type is received for this attribute).</li>
</ul>
<p>The Peripheral device enters in discovery mode with local name SlaveSec_A0. When a Central device starts the discovery procedure and detects the Peripheral device, the two devices connects. After connection, Peripheral device starts a slave security request to the Central device (aci_gap_slave_security_req()) and , as consequence, Central devices starts pairing procedure. After devices pairs and get bonded, Peripheral device displays the list of its bonded devices and configures its white list in order to add the bonded Central device to its white list. Central devices starts the service discovery procedure to identify the Peripheral service and characteristics and, then, enabling the TX characteristic notification. Peripheral device starts TX characteristic notification to the Central device at periodic interval, and it provides the RX characteristic value to the Central device each time it reads it. When connected, if user presses the Bluetooth LE platform button PUSH1, Peripheral device disconnects and enters in undirected connectable mode mode with filtering enabled (WHITE_LIST_FOR_ALL: Process scan and connection requests only from devices in the White List). This implies that Peripheral device accepts connection requests only from devices on its white list: Central device is still be able to connect to the Peripheral device; any other device connection requests are not accepted from the Peripheral device. </p><pre class="fragment"> Pairing with Numeric Comparison (Bluetooth LE V4.2 only) and bonding:
</pre><p>On reset, after initialization, Peripheral device sets security IO capability as Keyboard, display (IO_CAP_KEYBOARD_DISPLAY) and set authentication requirements as follow:</p>
<ul>
<li>MITM authentication (MITM_PROTECTION_REQUIRED)</li>
<li>use fixed pin (DONOT_USE_FIXED_PIN_FOR_PAIRING)</li>
<li>Secure connection supported but optional (SC_IS_SUPPORTED)</li>
<li>Key press notification not supported (KEYPRESS_IS_NOT_SUPPORTED)</li>
<li>Identity address public (0x00)</li>
<li>bonding required (BONDING)</li>
</ul>
<p>After initialization phase, Peripheral device defines a custom service with 2 proprietary characteristics (UUID 128 bits):</p>
<ul>
<li>TX characteristic: notification (CHAR_PROP_NOTIFY), no security (ATTR_PERMISSION_NONE);</li>
<li>RX characteristic with properties: read (CHAR_PROP_READ), Link must be encrypted to read (ATTR_PERMISSION_ENCRY_READ), Need authentication to read (ATTR_PERMISSION_AUTHEN_READ), GATT_NOTIFY_READ_REQ_AND_WAIT_FOR_APPL_RES (application is notified when a read request of any type is received for this attribute).</li>
</ul>
<p>The Peripheral device enters in discovery mode with local name SlaveSec_A3. When a Central device starts the discovery procedure and detects the Peripheral device, the two devices connects. After connection, Peripheral device starts a slave security request to the Central device (aci_gap_slave_security_req()) and , as consequence, Central devices starts pairing procedure.</p>
<p>On both devices the confirm numeric value event is triggered and the related numeric value is displayed. User is requested to press key y in order to confirm the numeric value on both devices (any other key for not confirming it). After devices pairs and get bonded, Peripheral device displays the list of its bonded devices and configures its white list in order to add the bonded Central device to its white list. Central devices starts the service discovery procedure to identify the Peripheral service and characteristics and, then, enabling the TX characteristic notification. Peripheral device starts TX characteristic notification to the Central device at periodic interval, and it provides the RX characteristic value to the Central device each time it reads it. When connected, if user presses the Bluetooth LE platform button PUSH1, Peripheral device disconnects and enters in undirected connectable mode mode with filtering enabled (WHITE_LIST_FOR_ALL: Process scan and connection requests only from devices in the White List). This implies that Peripheral device accepts connection requests only from devices on its white list: Central device is still be able to connect to the Peripheral device; any other device connection requests are not accepted from the Peripheral device.</p>
<p>GENERAL NOTE: TX and RX characteristics length is 20 bytes and related values are defined as follow:</p>
<ul>
<li>TX characteristic value: {'S','L','A','V','E','_','S','E','C','U','R','I','T','Y','_','T','X',' ',x1,x2}; where x1, x2 are counter values</li>
<li>RX characteristic value: {'S','L','A','V','E','_','S','E','C','U','R','I','T','Y','_','R','X',' ',x1,x2}; where x1, x2 are counter values</li>
<li>When using a Smarthphone as Central device, please notice that if this device uses a random resolvable address, Periheral device is able to accept connection or scan requests coming from it on reconnection phase. This is due to the fact, that when disconnecting, Peripheral device enters in undirected connectable mode with filtering enabled (WHITE_LIST_FOR_ALL: Process scan and connection requests only from devices in the White List). As consequence, it is able to accept Smarthphone's scan request or connection requests, only if the Controller Privacy is enabled on Peripheral device (please refer to the BlueNRG GUI SW package (STSW-BNRGUI) script: BlueNRG GUI x.x.x.py for a a complete reference example). A possible simple option, on Peripheral device, is to replace the WHITE_LIST_FOR_ALL advertising filter policy with NO_WHITE_LIST_USE: Peripheral device doesn't enable device filtering after reconnection, and it is able to accept connection or scan requests coming from a Smartphone using resolvable random addresses. </li>
</ul>

<p>Definition in file <a class="el" href="_p__main_8c_source.html">P_main.c</a>.</p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2022 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
